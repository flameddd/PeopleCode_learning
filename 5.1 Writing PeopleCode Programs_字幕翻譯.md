### **Lesson 5: 撰寫 PeopleCode 程式**
- 學習目標：撰寫 PeopleCode 陳述式、條件判斷及迴圈語法。
- 了解陳述式的基本組成，包括變數、函式、類別、方法、屬性及註解。
- 理解每個 PeopleCode 陳述式通常需以分號結尾，但某些結構（如 `If Then`）有例外。

### **PeopleCode 陳述式**
- 陳述式包括變數宣告、值指派、控制流（條件分支、迴圈）、函式及方法調用等。
- **分號 (;) 用於結束陳述式**，但像 `If Then` 結構直到 `End-If` 才視為完整陳述式。
- `If Then Else End-If` 屬於單一區塊，因此分號出現在 `End-If` 之後，而非 `Then` 之後。
- 同樣規則適用於其他控制流結構，如 `For` 迴圈。

### **賦值陳述式**
- 透過 `=` 將值賦予欄位、變數、物件屬性或物件本身，可為直接值、函式運算結果或其他變數。
- 例如：`&S1 = "String1"`，將字串指派給變數 `&S1`。
- 也可透過變數間指派，例如：`&S2 = &S1`，使 `&S2` 取得 `&S1` 的值。

### **運算式、函式與方法**
- 宣告變數：如 `Local String &S1, &S2`，表示同一行內定義兩個字串變數。
- 變數指派可為字串、數值、日期等基本類型，也可為物件導向資料型別。
- 例如：宣告 `RowSet` 物件：`Local RowSet &rowset1, &rowset2`，並透過 `CreateRowSet` 或 `GetRowSet` 進行物件實例化。

### **註解**
- **使用 `Rem`（Remark）標註單行註解**，直到第一個分號結束。
- **使用 C 風格註解 (`/* ... */`) 標註多行註解**，適用於較長的註解區段。
- `Rem` 方法源自傳統 BASIC 程式，而 C 風格適用於更靈活的多行註解。

 

### **區塊註解（Block Comments）**
- 使用**標籤符號 `<* ... *>`** 來標記註解區塊，適用於已含註解的程式碼段。
- 可以有效屏蔽多行程式碼，使其暫時無法執行。
- 適用於大範圍的註解，避免影響原有的其他註解結構。

### **編譯器自動產生的註解**
- **`/*+ ... +*/` 由編譯器自動插入**，使用者無法自行撰寫這類註解。
- 主要出現在**應用程式類別（Application Class）內的方法和屬性定義**。
- 這些註解是為了標記特定的程式碼結構，幫助開發環境理解類別設計。

### **PeopleCode 的數學運算子**
- **加法 (`+`)**：`&Price + &Tax` 用於數值相加。
- **減法 (`-`)**：`&Gross - &Tax` 可進行數值減法或一元負號運算（`- &Deductions`）。
- **乘法 (`*`)**：`&Price * &Quantity` 代表數值相乘。
- **除法 (`/`)**：`&AnnualPayments / 12` 代表除法運算。
- **指數運算 (`**`)**：`Radius ** 2` 代表指數運算，將 `Radius` 的值提升至平方。

### **運算順序與優先權**
- **遵循標準運算順序**（PEMDAS）：**括號、指數、乘除、加減**（同階運算依左至右）。
- 可透過**括號 `()` 覆蓋預設的計算優先權**，確保運算結果符合預期。
- 與一般程式語言的運算邏輯一致，可靈活運用於 PeopleCode 計算式中。

### **日期與時間運算**
- **時間 `+` 或 `-` 秒數**：結果仍為時間型別（Time）。
- **時間 `-` 時間**：結果為秒數（數值型別）。
- **日期 `+` 或 `-` 天數**：結果為新的日期（Date）。
- **日期 `-` 日期**：結果為天數差異（數值型別）。
- **日期 `+` 時間**：結果為日期時間型別（DateTime），兩者結合。


這裡是你的文章摘要，每段內容都整理成 3 到 5 條重點，並以台灣繁體中文表達：

### **日期與時間運算**
- `%Date` 代表**當前系統日期**，可進行日期運算，例如 `&Date1 = %Date + 7` 計算**七天後的日期**。
- `%Time` 代表**當前系統時間**，可進行秒數運算，例如 `&Time = %Time + 300` 計算**五分鐘後的時間**。
- `%Date` 和 `%Time` 的值來自**資料庫伺服器**，確保正確同步當前日期時間。

### **條件判斷 (`If Then Else` 結構)**
- **基本語法**：`If 條件 Then 陳述式列表 [Else 陳述式列表] End-If`。
- **巢狀結構**：`If` 可**巢狀嵌套多個條件**，形成多層判斷，例如：
  ```PeopleCode
  If %Mode = "A" Then
      If &Find > 0 Then
          Error "請確認條件"
      End-If
  End-If
  ```
- **無 `Else-If`**：PeopleSoft **不支援 `Else If`**，須使用 `Evaluate` 進行條件判斷。

### **關係與布林運算子**
- **關係運算子**：`=`（等於）、`<>`（不等於）、`>`（大於）、`<`（小於）、`>=`（大於等於）、`<=`（小於等於）。
- **布林運算子**：`Not`（非）、`And`（且）、`Or`（或）。
- **運算順序**：PeopleCode 依序計算 `Not` → `And` → `Or`，可使用**括號 `()`** 控制運算優先順序。

### **錯誤與警告處理**
- **錯誤 (`Error` 函式)**：顯示訊息並**停止處理**，直到使用者修正輸入。
- **示例**：
  ```PeopleCode
  If All(&EmpBirthDate) Then
      Error "請輸入生日"
  End-If
  ```
- **錯誤應在條件判斷後執行**，避免欄位無法更新或影響使用者操作。



### **錯誤 (`Error`) 函式**
- **主要功能**：顯示錯誤訊息，**停止 PeopleCode 處理**，使後續程式碼無法執行。
- **應用於欄位編輯 (`FieldEdit`) 時**，該欄位會變紅，並且使用者無法離開該欄位。
- **示例**：
  ```PeopleCode
  If &Employee.BirthDate > %Date Then
      Error "生日不得晚於今日"
  End-If
  ```
- **括號 (`()`) 是選擇性**，但通常建議使用以提高可讀性。

### **警告 (`Warning`) 函式**
- **主要功能**：顯示警告訊息，但不阻止處理，讓使用者決定是否繼續。
- **適用於數據檢查**，如**雇用日期應符合邏輯順序**。
- **示例**：
  ```PeopleCode
  If All(&Job.OrigHireDate, &Employment.HireDate) And 
     &Job.OrigHireDate > &Employment.HireDate Then
      Warning "原始雇用日期不應晚於正式雇用日期"
  End-If
  ```
- **使用者可選擇繼續或修正輸入**，與 `Error` 函式的強制性不同。

### **判斷值是否為「空」**
- **`All()` 函式回傳 `True`，當所有參數都不為 `Null`、`0` 或空字串**。
- **日期欄位的「空值」為 `Null`，數值欄位則為 `0`，文字欄位則為空白 (`""`)**。

### **錯誤與警告的區別**
- **`Error` 函式：強制停止程式執行，使用者必須修正輸入**。
- **`Warning` 函式：提示可能錯誤，使用者可選擇修正或忽略**。
- **適用於不同場景，例如 `Error` 用於嚴重錯誤，`Warning` 用於建議性檢查**。

### **可選括號 (`Optional Parentheses`)**
- **如果 `Error` 或 `Warning` 只包含簡單字串，可不使用括號**。
- **當使用 `MessageGet` 函式時，括號必須存在**：

```PeopleCode
Warning(MessageGet(1000, 5, "請確認資料"))
```


